---
title: "Smart buildings"
author: "Cameron Roach"
date: "9 November 2017"
bibliography: library.bib
nocite: |
  @Murphy2012-bc, @Friedman2001-vq
output:
  ioslides_presentation:
    css: css/styles.css
    logo: fig/BA-LOGO-RGB-Web-LRG.png
    widescreen: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
```

## Overview

* Smart buildings
* Analysing the data
* Building an end product

# Smart buildings | Trying to be smart with commercial building data

## How are buildings controlled



## What is a BMS?

* Commercial buildings contain Building Management Systems (BMSs).
* Control heating, cooling, ventilation and lighting systems.
* Typically contain a lot of sensors (>100,000).

# Analysing the data | Feature extraction, dimensionality reduction, clustering

## Feature extraction

* Collect data using our E2 device.
* Dealing with thousands of unevenly spaced time-series.
* We can extract features from the time-series.
* Each day of data will have


## Dimension reduction and clustering

* Too many sensors to visualise easily.
* Use dimensionality reduction.

----

### Which clustering algorithm?

Method | Advantages | Disadvantages 
-------|------------|----------------
K-means | Easy to learn | Outperformed by other algorithms
K-medoids | Better performance than K-means | Can suffer from local minima
Dirichlet process | | 
Affinity propagation | Automatically determines number of clusters | 
Spectral clustering | Good performance and efficient |
Hierarchical clustering | Produces a dendrogram - no "flat" clustering | 

----

<div class="centered">
![Image: @noauthor_2017-gy](fig/cluster_comparison.png)
</div>

----

### Spectral clustering

Given $n$ points $x_i \in \mathbb{R}^p$. The graph Laplacian is defined as follows

$$
\begin{split}
\mathbf{W} &= \left(w_{ij}\right) \in \mathbb{R}^{n \times n} \\
\mathbf{D} &= \mathrm{diag} \left( d_i \right) \\
\mathbf{L} &= \mathbf{D} - \mathbf{W},
\end{split}
$$

where,

* $w_{ij}$ is the weight between nodes $i$ and $j$, and,
* $d_i = \sum_{j=1}^n w_{ij}$ is the weighted degree of node $i$.

Find the $m$ eigenvectors $\mathbf{Z}_{n \times m}$ corresponding to the $m$ smallest eigenvalues of $\mathbf{L}$. Cluster the rows of $\mathbf{Z}_{n \times m}$ using K-means.


# Building an end product | Prototyping with Dash

## Dash

<div class="columns-2">
* Recently released by Plotly.
* Easily build web applications for data analytics.
* Open sourced under the MIT license.
* Python equivalent of `R`'s Shiny.

![](fig/dash-logo.svg)
</div>

## Simple example {.smaller}

```{python dash-simple-app, eval=FALSE}
import dash
from dash.dependencies import Input, Output
import dash_core_components as dcc
import dash_html_components as html
import pandas as pd

app = dash.Dash()

### <b>
app.layout = html.Div([
    dcc.Dropdown(id='my-dropdown',
                 options=['A', 'B', 'C']),
    dcc.Graph(id='my-graph')
])

@app.callback(Output('my-graph', 'figure'),
              [Input('my-dropdown', 'value')])
def update_graph(dd_value):
    df_query = df.query("Variable == @dd_value")
    return {'data': [{'x': df_query.x, 'y': df_query.y}]}
### </b>
    
if __name__ == '__main__':
    app.run_server()
```

## Demonstration

# Thank-you for listening! | Any questions?

## References {-}
